<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscrição na Viagem de Ônibus</title>
    <style>
        /* Estilos (mantidos os mesmos) */
    </style>
</head>
<body>
    <header>
        <h1>Inscrição na Viagem de Ônibus</h1>
    </header>
    <main>
        <form id="registration-form">
            <label for="name">Nome:</label>
            <input type="text" id="name" name="name" required>

            <label for="document">Número do Documento:</label>
            <input type="text" id="document" name="document" required>

            <button type="submit">Registrar</button>
        </form>
    </main>
    <div class="participants">
        <h2>Inscritos:</h2>
        <p>Vagas Disponíveis: <span id="available-seats">56</span></p>
        <ul id="participants-list"></ul>
    </div>
    <script>
        const socket = io();

        socket.on("update", (data) => {
            const participantsList = document.getElementById("participants-list");
            const availableSeatsElement = document.getElementById("available-seats");

            participantsList.innerHTML = "";
            data.participants.forEach((participant, index) => {
                participantsList.innerHTML += `
                    <li>
                        ${index + 1}. ${participant.name} - Documento: ${participant.documentNumber}
                        <button class="edit-button" data-document="${participant.documentNumber}">Editar</button>
                        <button class="delete-button" data-document="${participant.documentNumber}">Excluir</button>
                    </li>`;
            });

            availableSeatsElement.textContent = data.availableSeats;
        });

        socket.on("error", (message) => {
            alert(message);
        });

        document.addEventListener("DOMContentLoaded", function() {
            const form = document.getElementById("registration-form");
            const participantsList = document.getElementById("participants-list");

            form.addEventListener("submit", function(event) {
                event.preventDefault();
                const name = document.getElementById("name").value;
                const documentNumber = document.getElementById("document").value;

                socket.emit("register", { name, documentNumber });

                form.reset();
            });

            participantsList.addEventListener("click", (event) => {
                if (event.target.classList.contains("edit-button")) {
                    const documentNumber = event.target.getAttribute("data-document");
                    const newName = prompt("Digite o novo nome:");

                    if (newName !== null && newName !== "") {
                        socket.emit("edit", { documentNumber, newName });
                    }
                } else if (event.target.classList.contains("delete-button")) {
                    const documentNumber = event.target.getAttribute("data-document");
                    if (confirm("Tem certeza que deseja excluir este inscrito?")) {
                        socket.emit("delete", { documentNumber });
                    }
                }
            });
        });
    </script>
</body>
</html>
